<script>
  let url = "http://numbersapi.com";
  let number = Math.trunc(Math.random() * 500) + 1;
  let year = new Date().getFullYear();
  let trivia = "";
  let date = new Date();

  $: month = new Date(date).getUTCMonth() + 1;
  $: day = new Date(date).getUTCDate();

  $: api = {
    number: `${url}/${number}/trivia?json`,
    year: `${url}/${year}/year?json`,
    date: `${url}/${month}/${day}/date?json`,
  };

  let getEmoji = () => {
    let emojis = [
      "🤓",
      "🤯",
      "💬",
      "👌",
      "🧠",
      "👀",
      "🗯️",
      "📈",
      "🎉",
      "📖",
      "💡",
    ];
    let x = Math.floor((Math.random() * emojis.length) / 2);
    return emojis[x];
  };

  let fetchTrivia = async (uri) => {
    try {
      let response = await fetch(uri);
      let result = await response.json();
      trivia = `${getEmoji()} ${result.text}`;
    } catch (error) {
      console.log(error);
    }
  };
</script>

<main>
  <h1>📑 DigiTrivia ni Gracia</h1>
  <form on:submit|preventDefault={() => fetchTrivia(api.number)}>
    <label for="number">Type a Number:</label>
    <input type="number" name="number" bind:value={number} />
    <button>🔎 Show Trivia</button>
  </form>
  <form on:submit|preventDefault={() => fetchTrivia(api.year)}>
    <label for="year">Type a Year:</label>
    <input type="number" name="year" bind:value={year} />
    <button>🔎 Show Trivia</button>
  </form>
  <form on:submit|preventDefault={() => fetchTrivia(api.date)}>
    <label for="date">Type a Date:</label>
    <input type="date" name="date" bind:value={date} />
    <button>🔎 Show Trivia</button>
  </form>
  <h2>{trivia}</h2>
</main>

<style>
  main {
    text-align: center;
    height: 100vh;
    width: 50vw;
    margin: 0 auto;
  }

  input {
    width: 20%;
    margin: 1rem;
  }

  @media only screen and (max-width: 600px) {
    input {
      width: 100%;
      display: block;
    }
  }
</style>
